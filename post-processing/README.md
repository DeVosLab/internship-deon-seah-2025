# Post-MLP Visualisation of Predictions in napari

## `napari_points_predicted`: Visualising predicted classes in napari
Using napari, this script visualises MLP prediction results for a specified sample by plotting test set points in a three-dimensional space. It colours the points by ground truth labels, predicted class labels, and predicted probabilities, all contained within a CSV file generated by the `mlp_prediction` script in the `/models` subfolder. This offers intuitive, spatially-aware insights into the model's performance, useful for assessing prediction quality within the biological structure of the sample.

![image](https://github.com/user-attachments/assets/8b65bb5b-589f-4cd0-9e58-1f5ba3f50e76)
*Figure showing the cerebral organoid extracted from the HDF5 file, with points coloured by different labels. From left to right: ground truth labels, class label prediction on Channel 0 features, class label prediction on Channel 1 features, and predicted probabilities on Channel 0 features.*

```bash
python -m napari_points_predicted \
--h5_path /path/to/hdf5_file[_family_%d].h5 \
--labels_path /path/to/labels_file.csv \
--sample 3d_sample_001 \
--voxelsize 3 0.5 0.5 \
```
Input:
- One HDF5 file or file family.
- The labels CSV file generated from `mlp_prediction`, containing the coordinates, ground truth labels, predicted class labels, and predicted probabilities.

Parameters:
- `--h5_path`: Path to HDF5 file or file family member (replace `_0.h5` with `_%d.h5`).
- `--memb_size`: If input is a HDF5 file family, specify the size of each file family member.
- `--labels_path`: Path to CSV file containing point coordinates, ground truth labels, predicted class labels, and predicted probabilities, from MLP prediction.
- `--sample`: Specify sample to visualise, important for selecting correct image from HDF5 file.
- `--do_out_of_slice`: (Optional) If flagged, out of slice display will be toggled on for all points layers, can be toggled off manually later.
- `--hide_all_points`: (Optional) If flagged, all points layers visibility will be toggled off, can be toggled on manually later.
- `--point_size`: Specify the size of the points, default = 10.
- `--voxelsize`: Specify the voxel size of the points, default = [1, 1, 1].
- `--extract_slices`: (Optional) If flagged, only the 15 point-densest slices will be extracted and visualised.
- `--do_mip`: (Optional) If flagged, maximum intensity projection will be applied along the z-axis, converting the 3D image into 2D.

Output:
- No output folder will be created, but napari will be launched with the points layers rendered over the image layers.
